DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
echo DIR=$DIR


TRAVIS_CDEP_JAR=$DIR/cdep/libs/cdep-dev.jar
echo du -a -h --max-depth=1 . | grep "jar" | sort -hr
du -a -h --max-depth=1 . | grep "jar" | sort -hr
echo done
if [ ! -f "$TRAVIS_CDEP_JAR" ]; then
    TRAVIS_CDEP_JAR=$DIR/cdep/libs/cdep-${TRAVIS_TAG}.jar
fi
if [ ! -f "$TRAVIS_CDEP_JAR" ]; then
    echo Could not local cdep-xxx.jar, files available: $(ls $DIR/cdep/libs/*.jar)
    exit -1
fi


BOOTSTRAP_MANIFEST=$DIR/cdep/build/libs/bootstrap.yml
echo BOOTSTRAP_MANIFEST=$BOOTSTRAP_MANIFEST

echo entry: io.cdep.CDep > $BOOTSTRAP_MANIFEST
echo dependencies: >> $BOOTSTRAP_MANIFEST
printf "%s\n" "- $TRAVIS_CDEP_JAR" >>$BOOTSTRAP_MANIFEST
#printf "%s\n" "- https://search.maven.org/remotecontent?filepath=org/yaml/snakeyaml/1.17/snakeyaml-1.17.jar" >>$BOOTSTRAP_MANIFEST
cat $BOOTSTRAP_MANIFEST

echo ./cdep $BOOTSTRAP_MANIFEST
$DIR/.package/redist/cdep $BOOTSTRAP_MANIFEST wrapper
rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
./cdep $BOOTSTRAP_MANIFEST "$@"
rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi




